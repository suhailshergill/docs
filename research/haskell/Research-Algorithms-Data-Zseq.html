<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Research.Algorithms.Data.Zseq</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Research-Algorithms-Data-Zseq.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">research-0.1.0.0: repository to host code examples and source papers (when
possible)</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr><tr><th>Language</th><td>Haskell2010</td></tr><tr><th>Extensions</th><td><ul class="extension-list"><li>MonoLocalBinds</li><li>TypeFamilies</li><li>TypeSynonymInstances</li><li>FlexibleContexts</li><li>FlexibleInstances</li><li>ConstrainedClassMethods</li><li>MultiParamTypeClasses</li><li>KindSignatures</li><li>ExplicitNamespaces</li></ul></td></tr></table><p class="caption">Research.Algorithms.Data.Zseq</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Monomorphic example demonstrating ideas from &quot;Reflection without Remorse
 paper&quot; (<a href="http://okmij.org/ftp/Haskell/zseq.pdf">http://okmij.org/ftp/Haskell/zseq.pdf</a>). code below take hints from
 <a href="http://okmij.org/ftp/Haskell/Reflection.html#list-appends">http://okmij.org/ftp/Haskell/Reflection.html#list-appends</a>.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">class</span> <a href="#t:AbsSeq">AbsSeq</a> base <span class="keyword">where</span><ul class="subs"></ul></li><li class="src short"><span class="keyword">class</span> <a href="#t:AbsSeqImpl">AbsSeqImpl</a> impl base <span class="keyword">where</span><ul class="subs"><li><span class="keyword">type</span> <a href="#t:View">View</a> impl base :: <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Kind.html#t:-42-">*</a> -&gt; <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Kind.html#t:-42-">*</a></li></ul></li><li class="src short"><a href="#v:string2Seq">string2Seq</a> :: <a href="Research-Algorithms-Data-Zseq.html#t:AbsSeq">AbsSeq</a> base =&gt; <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-String.html#t:String">String</a> -&gt; base <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Char.html#t:Char">Char</a></li><li class="src short"><a href="#v:showSeq">showSeq</a> :: (<a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Eq.html#t:Eq">Eq</a> (impl base <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Char.html#t:Char">Char</a>), <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Text-Show.html#t:Show">Show</a> a, <a href="Research-Algorithms-Data-Zseq.html#t:AbsSeqImpl">AbsSeqImpl</a> impl base, <a href="Research-Algorithms-Data-Zseq.html#t:AbsSeq">AbsSeq</a> (impl base)) =&gt; <a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> a -&gt; impl base <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Char.html#t:Char">Char</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:List">List</a> a<ul class="subs"><li>= <a href="#v:Nil">Nil</a></li><li>| <a href="#v:Cons">Cons</a> a (<a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> a)</li></ul></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:Id">Id</a> base a = <a href="#v:Id">Id</a> {<ul class="subs"><li><a href="#v:unId">unId</a> :: base a</li></ul>}</li><li class="src short"><a href="#v:showRegular">showRegular</a> :: <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Text-Show.html#t:Show">Show</a> a =&gt; <a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> a -&gt; <a href="Research-Algorithms-Data-Zseq.html#t:Id">Id</a> <a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Char.html#t:Char">Char</a></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:CPS">CPS</a> base a = <a href="#v:CPS">CPS</a> {<ul class="subs"><li><a href="#v:unCPS">unCPS</a> :: base a -&gt; base a</li></ul>}</li><li class="src short"><a href="#v:showCPS">showCPS</a> :: <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Text-Show.html#t:Show">Show</a> a =&gt; <a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> a -&gt; <a href="Research-Algorithms-Data-Zseq.html#t:CPS">CPS</a> <a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Char.html#t:Char">Char</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:ListV-39-">ListV'</a> a = <a href="#v:ListV-39-">ListV'</a> (<a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/containers-0.5.7.1/Data-Sequence.html#t:Seq">Seq</a> (<a href="Research-Algorithms-Data-Zseq.html#t:ListV">ListV</a> a))</li><li class="src short"><span class="keyword">data</span> <a href="#t:ListV">ListV</a> a<ul class="subs"><li>= <a href="#v:NilV">NilV</a></li><li>| <a href="#v:ConsV">ConsV</a> a (<a href="Research-Algorithms-Data-Zseq.html#t:ListV-39-">ListV'</a> a)</li></ul></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:Zseq">Zseq</a> base a = <a href="#v:Zseq">Zseq</a> {<ul class="subs"><li><a href="#v:unZseq">unZseq</a> :: base a</li></ul>}</li><li class="src short"><a href="#v:showZseq">showZseq</a> :: <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Text-Show.html#t:Show">Show</a> a =&gt; <a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> a -&gt; <a href="Research-Algorithms-Data-Zseq.html#t:Zseq">Zseq</a> <a href="Research-Algorithms-Data-Zseq.html#t:ListV-39-">ListV'</a> <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Char.html#t:Char">Char</a></li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">class</span> <a href="#t:AbsSeq" id="t:AbsSeq" class="def">AbsSeq</a> base <span class="keyword">where</span></p><div class="doc"><p>the abstract interface for sequences</p></div><div class="subs minimal"><p class="caption">Minimal complete definition</p><p class="src"><a href="Research-Algorithms-Data-Zseq.html#v:nil">nil</a>, <a href="Research-Algorithms-Data-Zseq.html#v:cons">cons</a>, <a href="Research-Algorithms-Data-Zseq.html#v:deCons">deCons</a>, <a href="Research-Algorithms-Data-Zseq.html#v:foldr">foldr</a></p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:nil" id="v:nil" class="def">nil</a> :: base a</p><div class="doc"><p>constructor 1: the empty sequence</p></div><p class="src"><a href="#v:cons" id="v:cons" class="def">cons</a> :: a -&gt; base a -&gt; base a</p><div class="doc"><p>constructor 2: add an element to a sequence</p></div><p class="src"><a href="#v:deCons" id="v:deCons" class="def">deCons</a> :: base a -&gt; <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Maybe.html#t:Maybe">Maybe</a> (a, base a)</p><div class="doc"><p>deconstructor: either a sequence is empty, or we can extract a pair of
 (head, tail) from it</p></div><p class="src"><a href="#v:foldr" id="v:foldr" class="def">foldr</a> :: (a -&gt; f b -&gt; f b) -&gt; f b -&gt; base a -&gt; f b</p><div class="doc"><p>fold: the ability to make a pass over the sequence</p></div></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a href="#t:AbsSeqImpl" id="t:AbsSeqImpl" class="def">AbsSeqImpl</a> impl base <span class="keyword">where</span></p><div class="doc"><p>common &quot;template&quot; for various implementations</p></div><div class="subs minimal"><p class="caption">Minimal complete definition</p><p class="src"><a href="Research-Algorithms-Data-Zseq.html#v:toView">toView</a>, <a href="Research-Algorithms-Data-Zseq.html#v:fromView">fromView</a>, <a href="Research-Algorithms-Data-Zseq.html#v:-43--43-">(++)</a></p></div><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="#t:View" id="t:View" class="def">View</a> impl base :: <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Kind.html#t:-42-">*</a> -&gt; <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Kind.html#t:-42-">*</a></p><div class="doc"><p>the &quot;view&quot; type for an implementation</p></div></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toView" id="v:toView" class="def">toView</a> :: impl base a -&gt; <a href="Research-Algorithms-Data-Zseq.html#t:View">View</a> impl base a</p><div class="doc"><p>the ability to go from implementation type to the view type</p></div><p class="src"><a href="#v:fromView" id="v:fromView" class="def">fromView</a> :: <a href="Research-Algorithms-Data-Zseq.html#t:View">View</a> impl base a -&gt; impl base a</p><div class="doc"><p>the ability to for from view type to the implementation type</p></div><p class="src"><a href="#v:-43--43-" id="v:-43--43-" class="def">(++)</a> :: impl base a -&gt; impl base a -&gt; impl base a</p><div class="doc"><p>the binary, associative, asymmetric operation in question. note that it
 operates on the implementation datatypes</p></div></div></div><div class="top"><p class="src"><a href="#v:string2Seq" id="v:string2Seq" class="def">string2Seq</a> :: <a href="Research-Algorithms-Data-Zseq.html#t:AbsSeq">AbsSeq</a> base =&gt; <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-String.html#t:String">String</a> -&gt; base <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Char.html#t:Char">Char</a></p><div class="doc"><p>helper function to convert string to an abstract sequence. used for the
 examples to pretty print sequences which showcase &quot;reflection&quot;</p></div></div><div class="top"><p class="src"><a href="#v:showSeq" id="v:showSeq" class="def">showSeq</a> :: (<a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Eq.html#t:Eq">Eq</a> (impl base <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Char.html#t:Char">Char</a>), <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Text-Show.html#t:Show">Show</a> a, <a href="Research-Algorithms-Data-Zseq.html#t:AbsSeqImpl">AbsSeqImpl</a> impl base, <a href="Research-Algorithms-Data-Zseq.html#t:AbsSeq">AbsSeq</a> (impl base)) =&gt; <a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> a -&gt; impl base <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Char.html#t:Char">Char</a></p><div class="doc"><p>the example to pretty print sequences which showcases
 &quot;reflection&quot;. reflection here is defined as the need to inspect and modify
 intermediate results during the midst of a computation.</p><p>the code below can be understood on a per case bases. if the sequence is
 empty then the result of prety-printing it is quite simply &quot;[]&quot;. otherwise,
 calculate the result of pretty-printing the tail and then splice the result
 of pretty-printing the head in between. when splicing, if the result of
 pretty-printing the tail is &quot;[]&quot; don't append a comma, otherwise do.</p><p>rough complexity analysis:
 T(n) = O(<code><a href="Research-Algorithms-Data-Zseq.html#v:deCons">deCons</a></code>) + T(n-1) + O(<code><a href="Research-Algorithms-Data-Zseq.html#v:-43--43-">++</a></code>)</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a href="#t:List" id="t:List" class="def">List</a> a</p><div class="doc"><p>the traditional list datatype. note that since it implements AbsSeq, there
 is no need to export the constructors. in fact, it's preferred not to.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a href="#v:Nil" id="v:Nil" class="def">Nil</a></td><td class="doc"><p>the empty list</p></td></tr><tr><td class="src"><a href="#v:Cons" id="v:Cons" class="def">Cons</a> a (<a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> a)</td><td class="doc"><p>append an element to a list</p></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a href="#t:Id" id="t:Id" class="def">Id</a> base a</p><div class="doc"><p>datatype to represent scenario when our view type is the same as our base
 type.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a href="#v:Id" id="v:Id" class="def">Id</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a href="#v:unId" id="v:unId" class="def">unId</a> :: base a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a href="#v:showRegular" id="v:showRegular" class="def">showRegular</a> :: <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Text-Show.html#t:Show">Show</a> a =&gt; <a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> a -&gt; <a href="Research-Algorithms-Data-Zseq.html#t:Id">Id</a> <a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Char.html#t:Char">Char</a></p><div class="doc"><p>specializing the pretty-printing example.</p><p>T(n) = O(<code><a href="Research-Algorithms-Data-Zseq.html#v:deCons">deCons</a></code>) + T(n-1) + O(<code><a href="Research-Algorithms-Data-Zseq.html#v:-43--43-">++</a></code>)</p><p>T(n) = O(n) + O(n) + T(n-1)</p><p>T(n) = O(n^2)</p></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a href="#t:CPS" id="t:CPS" class="def">CPS</a> base a</p><div class="doc"><p>datatype to represent the CPS transformation</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a href="#v:CPS" id="v:CPS" class="def">CPS</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a href="#v:unCPS" id="v:unCPS" class="def">unCPS</a> :: base a -&gt; base a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a href="#v:showCPS" id="v:showCPS" class="def">showCPS</a> :: <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Text-Show.html#t:Show">Show</a> a =&gt; <a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> a -&gt; <a href="Research-Algorithms-Data-Zseq.html#t:CPS">CPS</a> <a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Char.html#t:Char">Char</a></p><div class="doc"><p>the pretty-printing example with the CPS transformation. note that simply
 specializing <code><a href="Research-Algorithms-Data-Zseq.html#v:showSeq">showSeq</a></code> doesn't work, because we have not defined equality on
 (CPS List Char). we could define equality on <code><a href="Research-Algorithms-Data-Zseq.html#t:CPS">CPS</a></code> by converting to and from
 view, but that could be wasteful. below we define <code><a href="Research-Algorithms-Data-Zseq.html#v:showCPS">showCPS</a></code> directly.</p><p>T(n) = O(<code><a href="Research-Algorithms-Data-Zseq.html#v:deCons">deCons</a></code>) + T(n-1) + O(<code><a href="Research-Algorithms-Data-Zseq.html#v:toView">toView</a></code>) + O(<code><a href="Research-Algorithms-Data-Zseq.html#v:-43--43-">++</a></code>)</p><p>T(n) = O(n) + T(n-1) + O(n) + O(1)</p><p>T(n) = O(n) + T(n-1)</p><p>T(n) = O(n^2)</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a href="#t:ListV-39-" id="t:ListV-39-" class="def">ListV'</a> a</p><div class="doc"><p>the base data type implemented using an efficient catenable sequence data
 structure. for present purposes we're using <code><a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/containers-0.5.7.1/Data-Sequence.html#t:Seq">Seq</a></code> which has O(log(min(m, n)))
 runtime, but there's nothing preventing us from using an O(1)
 implementation. as such in the rough back of the envelope complexity analysis
 we'll assume that we're using an O(1) catenable sequence internally.</p><p>TODO: use type-aligned package</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a href="#v:ListV-39-" id="v:ListV-39-" class="def">ListV'</a> (<a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/containers-0.5.7.1/Data-Sequence.html#t:Seq">Seq</a> (<a href="Research-Algorithms-Data-Zseq.html#t:ListV">ListV</a> a))</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a href="#t:ListV" id="t:ListV" class="def">ListV</a> a</p><div class="doc"><p>the view data type. note that the recursive references reference
 <code><a href="Research-Algorithms-Data-Zseq.html#t:ListV-39-">ListV'</a></code>. the idea is to not export the constructors for <code><a href="Research-Algorithms-Data-Zseq.html#t:ListV">ListV</a></code> (or even
 <code><a href="Research-Algorithms-Data-Zseq.html#t:ListV-39-">ListV'</a></code> for that matter), and instead expose <code><a href="Research-Algorithms-Data-Zseq.html#t:ListV-39-">ListV'</a></code> as an abstract
 sequence datatype.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a href="#v:NilV" id="v:NilV" class="def">NilV</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="#v:ConsV" id="v:ConsV" class="def">ConsV</a> a (<a href="Research-Algorithms-Data-Zseq.html#t:ListV-39-">ListV'</a> a)</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a href="#t:Zseq" id="t:Zseq" class="def">Zseq</a> base a</p><div class="doc"><p>datatype to represent &quot;reflection without remorse&quot; strategy</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a href="#v:Zseq" id="v:Zseq" class="def">Zseq</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a href="#v:unZseq" id="v:unZseq" class="def">unZseq</a> :: base a</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a href="#v:showZseq" id="v:showZseq" class="def">showZseq</a> :: <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Text-Show.html#t:Show">Show</a> a =&gt; <a href="Research-Algorithms-Data-Zseq.html#t:List">List</a> a -&gt; <a href="Research-Algorithms-Data-Zseq.html#t:Zseq">Zseq</a> <a href="Research-Algorithms-Data-Zseq.html#t:ListV-39-">ListV'</a> <a href="file:///opt/ghc/head/share/doc/ghc/html/libraries/base-4.9.0.0/Data-Char.html#t:Char">Char</a></p><div class="doc"><p>specializing the pretty-printing example. this is where we see the real
 strength of this technique.</p><p>T(n) = O(<code><a href="Research-Algorithms-Data-Zseq.html#v:deCons">deCons</a></code>) + T(n-1) + O(<code><a href="Research-Algorithms-Data-Zseq.html#v:-43--43-">++</a></code>)</p><p>T(n) = O(1) + T(n-1) + O(1)</p><p>T(n) = O(n)</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.0</p></div></body></html>